# Models

#### Links to Model Runs:

**SFT**

[Standard Fine Tuned (SFT) BERT Results](#model-evaluation)

**HiT**

[HiT Model (Domain Tuned on SNOMED CT, Random Mixed Negatives)](#model-results-and-model-re-training)

[HiT Model (Domain Tuned on SNOMED CT, Hard Multi Negatives)](#)

**OnT**

[OnT PLM (all-MiniLM-L12-v2) Re-Trained](#ont-model-full-1-initial-re-training-attempt-w-modified-parameters)

[OnT PLM Re-Trained \w Cosine Annealing & Accumulated Gradients](#ont-model-training-run-2-exploratory-run-w-cosine-annealing-accumulated-gradients)

[OnT PLM Re-Trained \w Cosine Annealing, Acc Grads & Downweighted Logical Loss](#ont-model-training-run-3-exploratory-run-w-cosine-annealing-accumulated-gradients--modified-logical-loss)

[OnT Re-Trained Domain Tuned HiT (Mixed-Hop Prediction) Model](#ont-model-training-run-4-re-training-hit-tuned-model)

[OnT PLM Re-Trained Pre-longed Training Run (20 epochs)](#ont-model-training-run-5-pre-longed-training-run-for-ont-on-standard-plm-base-model-w-training-modified-parameters)

## SBERT 

<u>all-MiniLM-L12-v2:</u>

```
                threshold       precision               recall                  f1                      accuracy                accuracy_on_negatives
validation      0.758           0.2139370739459991      0.4426949918270111      0.2884686291217804      0.801464855670929       0.837341845035553
testing         0.758           0.21339061856269836     0.44347137212753296     0.28813549876213074     0.8007935285568237      0.8365257382392883
```

<u>SBERT SFT on SNOMED-CT</u>

```
                threshold       precision               recall                  f1                      accuracy                accuracy_on_negatives
testing         0.5             0.9442898631095886      0.7562966346740723      0.8399022817611694      0.973788857460022       0.9955381155014038
```

## HiT SNOMED CT Domain Tuned (Random Mixed Negatives, Mixed-Hop Prediction)

*Experiment Name: HiT-all-MiniLM-L12-v2-hit_dataset-mixed*

```
              centri_weight   threshold       precision               recall                  f1                      accuracy                accuracy_on_negatives
epoch=1.0     1.0             -17.49          0.9171475768089294      0.9067903757095336      0.9119395613670348      0.9840794205665588      0.991808295249939
epoch=2.0     0.9             -19.3           0.9171701073646544      0.9081807732582092      0.9126533269882202      0.984196662902832       0.991798222064972
epoch=3.0     0.9             -20.67          0.9252043962478638      0.92322438955307        0.9242133498191832      0.9862353801727296      0.9925364255905152
epoch=4.0     0.7             -21.76          0.9400038719177246      0.9573206901550292      0.9485833048820496      0.9905654191970824      0.99388986825943
epoch=5.0     0.7             -22.64          0.9401056170463562      0.9621909260749816      0.9510200619697572      0.9909899830818176      0.9938698410987854
epoch=6.0     0.7             -23.08          0.938044011592865       0.9609575271606444      0.9493625164031982      0.9906807541847228      0.9936530590057372
epoch=7.0     0.6             -23.76          0.94743674993515        0.9644322395324708      0.9558589458465576      0.9919024109840392      0.9946494102478028
epoch=8.0     0.7             -24.06          0.9433408975601196      0.9607574343681335      0.9519695043563844      0.9911866188049316      0.99422949552536
epoch=9.0     0.8             -23.65          0.9467164874076844      0.9637661576271056      0.9551652073860168      0.99177485704422        0.9945756793022156
epoch=10.0    0.7             -24.7           0.9469810724258424      0.9609752297401428      0.9539268016815186      0.9915611743927002      0.9946197271347046
epoch=11.0    0.8             -23.82          0.9496983289718628      0.9639611840248108      0.9567765593528748      0.9920822381973268      0.99489426612854
epoch=12.0    0.8             -24.44          0.9459070563316344      0.9616413116455078      0.9537093043327332      0.9915135502815248      0.994500696659088
epoch=13.0    0.8             -24.39          0.9493536949157716      0.9633204340934752      0.956286072731018       0.9919936060905457      0.9948608875274658
epoch=14.0    0.7             -25.42          0.9471782445907592      0.9633558988571168      0.9551985859870912      0.9917847514152528      0.9946275949478148
epoch=15.0    0.7             -25.56          0.949418842792511       0.9654832482337952      0.957383632659912       0.9921860694885254      0.994856297969818
epoch=16.0    0.8             -25.34          0.9488932490348816      0.9648526310920716      0.9568063616752625      0.9920806288719176      0.9948033690452576
epoch=17.0    0.8             -24.98          0.9491025805473328      0.9665317535400392      0.9577378630638124      0.9922454357147216      0.994816780090332
epoch=18.0    0.7             -25.47          0.9512071013450624      0.9629101753234864      0.9570228457450868      0.9921379089355468      0.9950606822967528
epoch=19.0    0.7             -25.68          0.9524450898170472      0.9651692509651184      0.958764910697937       0.9924526810646056      0.9951809644699096
epoch=20.0    0.7             -25.75          0.9506394863128662      0.965316116809845       0.9579216241836548      0.9922903776168824      0.994987726211548
testing       0.7             -25.68          0.9522665739059448      0.9647108912467957      0.9584484100341797      0.99239581823349        0.9951642751693726
```

<u>Evaluation: HiT PLM re-training (all-MiniLM-L12-v2), Random Negatives, Mixed-Hop Prediction</u>

```
                centri_weight   threshold       precision               recall                  f1                      accuracy                accuracy_on_negatives
validation      0.7             -25.68          0.9524450898170472      0.9651692509651184      0.958764910697937       0.9924526810646056      0.9951809644699096
testing         0.7             -25.68          0.9522665739059448      0.9647108912467957      0.9584484100341797      0.99239581823349        0.9951642751693726
```

## OnT PLM (all-MiniLM-L12-v2) Re-Trained

*Experiment Name: OnTr-all-MiniLM-L12-v2-H200-OnT-F-64-LR-5e-6--epochs-2*

* Ontology: SNOMED~CT, Pinned: Sept-25 (FULL ONTOLOGY)

*Parameters:*

* Batch Size: 64
* Learning Rate: 5e-6
* Epochs: 2

```
                   axiom_kind  centri_weight  H@1                     H@10                    H@100                   MRR                     MR                      median  AUC
epoch=1.0          nf1         0.8            0.0001469042749144      0.4969545613777361      0.7614726588543727      0.1577845671986687      888.1951905800458       11.0    0.9988402419205872
epoch=2.0          nf1         0.8            0.0001469042749144      0.5080853852847118      0.7676878397161357      0.1594987422356835      798.2874125637056       10.0    0.9989579476085227
sentence_nf1       nf1         0.8            0.00012380547065423452  0.39728401748752273     0.6069485820404689      0.12496354101779186     6406.3549734978915      25.0    0.9916044554200499
sentence_nf2       nf2         0.8            0.343369575318279       0.6421336307034662      0.8757550413530341      0.4332986059475026      413.3315862838026       5.0     0.9994628145414776
sentence_nf3       nf3         0.8            0.26370598279039104     0.38855172180616365     0.6665426943688402      0.3009283908001048      2507.2952005815428      25.0    0.9967203346574399
sentence_nf4       nf4         0.8            0.8968276488281028      0.9451222972589524      0.981839850178764       0.9126695730789114      14.233130923330117      1.0     0.9999829002753006
sentence_combined  combined    0.8            0.19203353168035595     0.48315718167612215     0.7016096130308606      0.28230296429238527     3844.0169736811717      12.0    0.9949627959787084
```

### OnT PLM Re-Trained \w Cosine Annealing & Accumulated Gradients

*Experiment Name: OnTr-all-MiniLM-L12-v2-H200-OnT-FULL-64-LR-1e-5-cosine-annealing-2-epochs-grad-acc-8*

*Parameters:*

* Ontology: SNOMED~CT, Pinned: Sept-2025 (FULL ONTOLOGY)
* Batch Size: 64
* Learning Rate: 1e-5
* Annealing Strategy: cosine
* Epochs: 2
* Accumulated Gradients: Yes
* Accumulated Gradient Value: 8
* Effective Batch Size: 512
* Logical Loss (conj & exist): 1.0
* Clustering Loss Margin: 3.0 $ \times 1.0$
* Centripetal Loss Margin: 1.0 $ \times 0.5$
* Base Model (PLM): all-MiniLM-L12-v2

```
                  axiom_kind  centri_weight   H@1                     H@10                    H@100                   MRR                     MR                      median  AUC
epoch=1.0         nf1         0.9             0.0001469042749144      0.4932593538471969      0.7441605550721526      0.160494400495456       1003.868565875267       11.0    0.9986887143037052
epoch=2.0         nf1         0.9             0.0001469042749144      0.5021753133016171      0.754748963194829       0.1600862770609751      906.1033754082245       10.0    0.9988167145217716
sentence_nf1      nf1         0.9             0.00012380547065423452  0.38636592254420243     0.5966727279761674      0.1259697188158189      3937.3332843270014      30.0    0.9948416264375664
sentence_nf2      nf2         0.9             0.335117554130657       0.626187157327386       0.8612396617414738      0.4212456753416027      546.5821392063934       5.0     0.9992887470660498
sentence_nf3      nf3         0.9             0.2641455209372306      0.3981539397832739      0.6713438033573952      0.30372501579571387     2765.7638496779537      24.0    0.9963816765919677
sentence_nf4      nf4         0.9             0.8978491572555474      0.9468815617728846      0.9707735088814483      0.9140518187372619      27.092333011747346      1.0     0.9999661197881216
sentence_combined combined    0.9             0.1904939687622684      0.4767295064931066      0.6938348202945184      0.28103786990019947     2703.2059165402943      13.0    0.9964586118199495
```

## OnT PLM Re-Trained \w Cosine Annealing, Acc Grads & Downweighted Logical Loss

*Experiment Name: OnTr-all-MiniLM-L12-v2-H200-OnT-FULL-64-LR-1e-5-cosine-annealing-2-epochs-grad-acc-8-downweighted-logical-loss*

* Ontology: SNOMED~CT, Pinned: Sept-2025 (FULL ONTOLOGY)

*Parameters:*

* Batch Size: 64
* Learning Rate: 1e-5
* Annealing Strategy: cosine
* Epochs: 2
* Accumulated Gradients: Yes
* Accumulated Gradient Value: 8
* Effective Batch Size: 512
* Logical Loss (conj & exist): 0.5
* Clustering Loss Margin: 3.0 $ \times 1.0$
* Centripetal Loss Margin: 1.0 $ \times 0.5$
* Base Model (PLM): all-MiniLM-L12-v2

```
                   axiom_kind      centri_weight   H@1                     H@10                    H@100                   MRR                     MR                      median  AUC
epoch=1.0          nf1             0.8             0.0001469042749144      0.4896432486185348      0.7496299142305041      0.1551337592514473      916.7052083215622       11.0    0.9988025272655064
epoch=2.0          nf1             0.8             0.0001469042749144      0.4976777824234685      0.7585345733560847      0.1559213807422997      817.3492592634445       11.0    0.9989329661267078
sentence_nf1       nf1             0.8             0.00012380547065423452  0.3891515456339227      0.6073432119781793      0.12296676851482523     3859.352365845166       27.0    0.9949438938156662
sentence_nf2       nf2             0.8             0.38866276368367253     0.7248025276461295      0.9021094693801691      0.4925682632683548      326.3870272279528       3.0     0.999576315707251
sentence_nf3       nf3             0.8             0.26416242625057057     0.4083478437272835      0.6850032965361013      0.30627120915396205     2517.114753266952       21.0    0.9967068304457782
sentence_nf4       nf4             0.8             0.8989274161511832      0.9476193178593724      0.9744622893138868      0.915193891186155       26.72771125361784       1.0     0.9999667847143772
sentence_combined  combined        0.8             0.2016596488256984      0.5009083421216717      0.7109663066655376      0.29497154936163117     2562.181079541518       10.0    0.996643318174559
```

## OnT Re-Trained Domain Tuned HiT (Mixed-Hop Prediction) Model

*Experiment Name: OnTr-final-H200-OnT-FULL-HiT-RETRAINED-2-EPOCHS*

* Ontology: SNOMED~CT, Pinned: Sept-2025 (FULL ONTOLOGY)

*Parameters:*

* Batch Size: 64
* Learning Rate: 1e-5
* Annealing Strategy: cosine
* Epochs: 2
* Accumulated Gradients: Yes
* Accumulated Gradient Value: 8
* Effective Batch Size: 512
* Logical Loss (conj & exist): 1.0
* Clustering Loss Margin: 3.0 $ \times 1.0$
* Centripetal Loss Margin: 1.0 $ \times 0.5$
* Base Model: Pre-trained HiT Model

```sh
2025-10-01 22:00:15 {'cluster_loss': 0.0, 'centri_loss': 0.0301, 'combined_loss': 0.5301, 'epoch': 2.0}
2025-10-01 22:00:16 {'cluster_loss': 0.0, 'centri_loss': 0.0338, 'combined_loss': 0.5338, 'epoch': 2.0}
2025-10-01 22:00:16 {'cluster_loss': 0.0206, 'centri_loss': 0.0181, 'combined_loss': 0.5395, 'epoch': 2.0}
2025-10-01 22:00:16 {'cluster_loss': 0.0, 'centri_loss': 0.0073, 'combined_loss': 0.5073, 'epoch': 2.0}
2025-10-01 22:00:17 {'cluster_loss': 0.0, 'centri_loss': 0.0213, 'combined_loss': 0.5246, 'epoch': 2.0}
2025-10-01 22:00:24 Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:13<00:00, 200.23it/s]
2025-10-01 22:02:28 Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
2025-10-01 22:02:41 Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:13<00:00, 209.37it/s]
2025-10-01 22:07:36 computing metrics.......
2025-10-01 22:07:36 H1: 13, H10: 27737, H100: 60168
2025-10-01 22:07:36 MRR: 0.10316016355184805, MR: 201.71199981919474
2025-10-01 22:07:38 Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
2025-10-01 22:07:51 Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:13<00:00, 200.22it/s]
2025-10-01 22:12:46 computing metrics.......
2025-10-01 22:12:46 H1: 13, H10: 28798, H100: 66340
2025-10-01 22:12:46 MRR: 0.10780967706670237, MR: 177.76278349699976
2025-10-01 22:12:48 Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.38it/s]
2025-10-01 22:13:02 Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:13<00:00, 200.58it/s]
2025-10-01 22:17:57 computing metrics.......
2025-10-01 22:17:57 H1: 13, H10: 30665, H100: 71039
2025-10-01 22:17:57 MRR: 0.11417863856790901, MR: 164.8614353677692
2025-10-01 22:17:58 Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:54<00:00,  9.38it/s]
2025-10-01 22:18:12 Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:13<00:00, 202.88it/s]
2025-10-01 22:23:07 computing metrics.......
2025-10-01 22:23:07 H1: 13, H10: 33405, H100: 73344
2025-10-01 22:23:07 MRR: 0.12216669407656956, MR: 158.27403297435956
2025-10-01 22:23:08 Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
2025-10-01 22:23:22 Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:13<00:00, 203.45it/s]
2025-10-01 22:28:17 computing metrics.......
2025-10-01 22:28:17 H1: 13, H10: 37112, H100: 74429
2025-10-01 22:28:17 MRR: 0.13195422295436954, MR: 155.60243183076628
2025-10-01 22:28:18 Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.38it/s]
2025-10-01 22:28:32 Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:13<00:00, 205.51it/s]
2025-10-01 22:33:27 computing metrics.......
2025-10-01 22:33:27 H1: 13, H10: 40987, H100: 74962
2025-10-01 22:33:27 MRR: 0.14261452946589964, MR: 155.6123535194874
2025-10-01 22:33:28 Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
2025-10-01 22:33:42 Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:13<00:00, 203.58it/s]
2025-10-01 22:38:37 computing metrics.......
2025-10-01 22:38:37 H1: 13, H10: 44107, H100: 75217
2025-10-01 22:38:37 MRR: 0.15387819435729005, MR: 157.666549896602
2025-10-01 22:38:38 Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.38it/s]
2025-10-01 22:38:52 Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:13<00:00, 203.41it/s]
2025-10-01 22:43:47 computing metrics.......
2025-10-01 22:43:47 H1: 13, H10: 45900, H100: 75337
2025-10-01 22:43:47 MRR: 0.16402741770949314, MR: 161.38946583345574
2025-10-01 22:43:48 Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.38it/s]
2025-10-01 22:44:02 Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:13<00:00, 202.30it/s]
2025-10-01 22:48:57 computing metrics.......
2025-10-01 22:48:57 H1: 13, H10: 46664, H100: 75333
2025-10-01 22:48:57 MRR: 0.17126750478394723, MR: 166.63070525352288
2025-10-01 22:48:58 Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
2025-10-01 22:49:12 Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:13<00:00, 198.95it/s]
2025-10-01 22:54:07 computing metrics.......
2025-10-01 22:54:07 H1: 13, H10: 46695, H100: 75230
2025-10-01 22:54:07 MRR: 0.17583078562820947, MR: 173.3383883471009
2025-10-01 22:54:08 Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
2025-10-01 22:54:22 Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:13<00:00, 203.16it/s]
2025-10-01 22:59:17 computing metrics.......
2025-10-01 22:59:17 H1: 13, H10: 46153, H100: 75095
2025-10-01 22:59:17 MRR: 0.17681633684335854, MR: 181.51068446091782
2025-10-01 22:59:18 Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.38it/s]
2025-10-01 22:59:32 Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:13<00:00, 202.40it/s]
2025-10-01 23:04:27 computing metrics.......
2025-10-01 23:04:27 H1: 13, H10: 45439, H100: 74898
2025-10-01 23:04:27 MRR: 0.1746389717745627, MR: 191.1758331167437
2025-10-01 23:04:29 Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
2025-10-01 23:04:42 Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:13<00:00, 200.99it/s]
2025-10-01 23:09:37 computing metrics.......
2025-10-01 23:09:37 H1: 13, H10: 44448, H100: 74627
2025-10-01 23:09:37 MRR: 0.17084648395293703, MR: 202.43613619156318
2025-10-01 23:09:39 Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.38it/s]
2025-10-01 23:09:53 Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:13<00:00, 205.86it/s]
2025-10-01 23:14:48 computing metrics.......
2025-10-01 23:14:48 H1: 14, H10: 43176, H100: 74268
2025-10-01 23:14:48 MRR: 0.16636958593556345, MR: 215.39327404427468
2025-10-01 23:14:49 Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
2025-10-01 23:15:02 Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:13<00:00, 200.78it/s]
2025-10-01 23:19:58 computing metrics.......
2025-10-01 23:19:58 H1: 19, H10: 41753, H100: 73834
2025-10-01 23:19:58 MRR: 0.16118680059658252, MR: 230.1759800210186
2025-10-01 23:19:59 Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.38it/s]
2025-10-01 23:20:13 Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:13<00:00, 205.81it/s]
2025-10-01 23:25:08 computing metrics.......
2025-10-01 23:25:08 H1: 174, H10: 40090, H100: 73308
2025-10-01 23:25:08 MRR: 0.15620830566037883, MR: 246.92055868825784
2025-10-01 23:25:09 Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
2025-10-01 23:25:23 Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:13<00:00, 206.15it/s]
2025-10-01 23:30:18 computing metrics.......
2025-10-01 23:30:18 H1: 1568, H10: 38430, H100: 72798
2025-10-01 23:30:18 MRR: 0.1587186510948388, MR: 265.80373588871436
2025-10-01 23:30:19 Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.38it/s]
2025-10-01 23:30:33 Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:13<00:00, 203.21it/s]
2025-10-01 23:35:28 computing metrics.......
2025-10-01 23:35:28 H1: 5769, H10: 36714, H100: 72229
2025-10-01 23:35:28 MRR: 0.17764314773965903, MR: 286.9802583255173
2025-10-01 23:35:30 Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
2025-10-01 23:35:43 Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:13<00:00, 201.81it/s]
2025-10-01 23:40:38 computing metrics.......
2025-10-01 23:40:38 H1: 10923, H10: 34966, H100: 71552
2025-10-01 23:40:38 MRR: 0.20252332240601215, MR: 310.7398438294554
2025-10-01 23:40:40 Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.38it/s]
2025-10-01 23:40:54 INFO:hierarchy_transformers.evaluation.ont_eval:Eval results: {'axiom_kind': 'nf1', 'centri_weight': 1.9, 'H@1': np.float64(0.15170691467121694), 'H@10': np.float64(0.37639135298837195), 'H@100': np.float64(0.8001084831568599), 'MRR': np.float64(0.2132874196855529), 'MR': np.float64(337.29456567186105), 'median': np.float64(16.0), 'AUC': np.float64(0.9995629469363853)}
2025-10-01 23:45:49 computing metrics.......
2025-10-01 23:45:49 H1: 13425, H10: 33308, H100: 70804
2025-10-01 23:45:49 MRR: 0.2132874196855529, MR: 337.29456567186105
2025-10-01 23:45:50 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4972/4972 [6:49:36<00:00,  1.78s/it]INFO:sentence_transformers.trainer:Saving model checkpoint to experiments/OnTr-final-H200-OnT-FULL-HiT-RETRAINED-2-EPOCHS/checkpoint-4972
2025-10-01 23:45:50 {'eval_axiom_kind': 'nf1', 'eval_centri_weight': 1.9, 'eval_H@1': np.float64(0.15170691467121694), 'eval_H@10': np.float64(0.37639135298837195), 'eval_H@100': np.float64(0.8001084831568599), 'eval_MRR': np.float64(0.2132874196855529), 'eval_MR': np.float64(337.29456567186105), 'eval_median': np.float64(16.0), 'eval_AUC': np.float64(0.9995629469363853), 'eval_runtime': 6333.2745, 'eval_samples_per_second': 0.0, 'eval_steps_per_second': 0.0, 'epoch': 2.0}
2025-10-01 23:45:50 INFO:sentence_transformers.SentenceTransformer:Save model to experiments/OnTr-final-H200-OnT-FULL-HiT-RETRAINED-2-EPOCHS/checkpoint-4972
2025-10-01 23:45:51 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4972/4972 [6:49:37<00:00,  4.94s/it]
2025-10-01 23:45:51 {'train_runtime': 24577.9099, 'train_samples_per_second': 103.538, 'train_steps_per_second': 0.202, 'train_loss': 0.5525434498621971, 'epoch': 2.0}
2025-10-01 23:45:51 1.9
2025-10-01 23:45:58 Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23835/23835 [02:03<00:00, 192.23it/s]
2025-10-01 23:48:04 Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4039/4039 [00:20<00:00, 194.86it/s]
2025-10-01 23:48:25 Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4039/4039 [07:10<00:00,  9.38it/s]
2025-10-01 23:55:36 computing metrics.......
2025-10-01 23:55:36 H1: 13322, H10: 37644, H100: 80155
2025-10-01 23:55:36 MRR: 0.1536122787617792, MR: 3432.6108252408403
2025-10-01 23:56:02 INFO:hierarchy_transformers.evaluation.ont_eval:Eval results nf1: {'axiom_kind': 'nf1', 'centri_weight': 1.9, 'H@1': np.float64(0.10308353000348203), 'H@10': np.float64(0.2912833210817503), 'H@100': np.float64(0.6202267187681356), 'MRR': np.float64(0.1536122787617792), 'MR': np.float64(3432.6108252408403), 'median': np.float64(34.0), 'AUC': np.float64(0.9955024186707613)}
2025-10-01 23:56:02 Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1682/1682 [00:09<00:00, 181.29it/s]
2025-10-01 23:56:18 Evaluating nf2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1682/1682 [02:59<00:00,  9.38it/s]
2025-10-01 23:59:17 computing metrics.......
2025-10-01 23:59:17 H1: 12616, H10: 22284, H100: 40964
2025-10-01 23:59:17 MRR: 0.28456347173981067, MR: 802.0295511569557
2025-10-01 23:59:19 INFO:hierarchy_transformers.evaluation.ont_eval:Eval results nf2: {'axiom_kind': 'nf2', 'centri_weight': 1.9, 'H@1': np.float64(0.2344763497816188), 'H@10': np.float64(0.4141622525787566), 'H@100': np.float64(0.7613418827246539), 'MRR': np.float64(0.28456347173981067), 'MR': np.float64(802.0295511569557), 'median': np.float64(15.0), 'AUC': np.float64(0.9989555094829023)}
2025-10-01 23:59:20 Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1849/1849 [00:09<00:00, 191.35it/s]
2025-10-01 23:59:34 Evaluating nf3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1849/1849 [05:55<00:00,  5.20it/s]
2025-10-02 00:05:30 computing metrics.......
2025-10-02 00:05:30 H1: 15646, H10: 25507, H100: 42687
2025-10-02 00:05:30 MRR: 0.31190982422638075, MR: 1557.1651649113317
2025-10-02 00:05:34 INFO:hierarchy_transformers.evaluation.ont_eval:Eval results nf3: {'axiom_kind': 'nf3', 'centri_weight': 1.9, 'H@1': np.float64(0.2645005325173702), 'H@10': np.float64(0.43120382736294016), 'H@100': np.float64(0.7216371105438439), 'MRR': np.float64(0.31190982422638075), 'MR': np.float64(1557.1651649113317), 'median': np.float64(16.0), 'AUC': np.float64(0.9979687240698933)}
2025-10-02 00:05:34 Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 551/551 [00:02<00:00, 187.28it/s]
2025-10-02 00:05:38 Evaluating nf4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 551/551 [00:58<00:00,  9.37it/s]
2025-10-02 00:06:37 computing metrics.......
2025-10-02 00:06:37 H1: 15130, H10: 16736, H100: 17599
2025-10-02 00:06:37 MRR: 0.8826542842989215, MR: 2.8383746665909992
2025-10-02 00:06:37 INFO:hierarchy_transformers.evaluation.ont_eval:Eval results nf4: {'axiom_kind': 'nf4', 'centri_weight': 1.9, 'H@1': np.float64(0.8586345837353159), 'H@10': np.float64(0.9497758356506442), 'H@100': np.float64(0.99875148969979), 'MRR': np.float64(0.8826542842989215), 'MR': np.float64(2.8383746665909992), 'median': np.float64(1.0), 'AUC': np.float64(0.9999976355738721)}
2025-10-02 00:06:54 INFO:hierarchy_transformers.evaluation.ont_eval:Combined eval results: {'axiom_kind': 'combined', 'centri_weight': 1.9, 'H@1': 0.218286928341044, 'H@10': 0.3932467072598089, 'H@100': 0.6982110278891822, 'MRR': np.float64(0.26621611390777034), 'MR': np.float64(2228.238917071443), 'median': np.float64(19.0), 'AUC': np.float64(0.9970816233001082)}
2025-10-02 00:06:54 INFO:sentence_transformers.SentenceTransformer:Save model to experiments/OnTr-final-H200-OnT-FULL-HiT-RETRAINED-2-EPOCHS/final
```

## OnT PLM Re-Trained Pre-longed Training Run (20 epochs)

*Experiment Name: OnTr-all-MiniLM-L12-v2-H200-OnT-FULL-64-LR-5e-6-cosine-annealing-20-epochs-grad-acc-8-downweighted-logical-loss-075-downweighted-centripetal-loss-085*

* Ontology: SNOMED~CT, Pinned: Sept-2025 (FULL ONTOLOGY)

*Parameters:*

* Batch Size: 64
* Learning Rate: 5e-6
* Annealing Strategy: cosine
* Epochs: 20
* Accumulated Gradients: Yes
* Accumulated Gradient Value: 8
* Effective Batch Size: 512
* Logical Loss (conj & exist): 0.75
* Clustering Loss Margin: 3.0 $ \times 1.0$
* Centripetal Loss Margin: 0.85 $ \times 0.5$
* Base Model (PLM): all-MiniLM-L12-v2

```
                axiom_kind      centri_weight   H@1                     H@10                    H@100                   MRR                     MR                      median  AUC
epoch=1.0       nf1             0.9             0.0001469042749144      0.4756873425016668      0.727492570033788       0.15288017074937227     1212.916806979083       12.0    0.998415201541064
epoch=2.0       nf1             0.8             0.0001469042749144      0.492287525566994       0.755822494434588       0.15303477786140263     844.3167143163867       11.0    0.9988977490005044
epoch=3.0       nf1             0.8             0.0001469042749144      0.511125173742556       0.767733041031494       0.1620969516493715      740.4182816719966       10.0    0.9990333749333555
epoch=4.0       nf1             0.8             0.0001469042749144      0.5152610940978383      0.7747166442543478      0.1618446886218065      641.849683025776        10.0    0.9991630788747093
epoch=5.0       nf1             1.9             0.1027990914535613      0.2788243137875312      0.5776276089634208      0.17246340918694494     1907.512289107613       54.0    0.997504584371777
epoch=6.0       nf1             0.8             0.0001469042749144      0.5259512051800708      0.7832144915417039      0.1628191742606925      583.7270179562225       9.0     0.9992394594462995
epoch=7.0       nf1             0.8             0.0001469042749144      0.5310928548020747      0.7860508740804357      0.1704109231412085      548.8862169889144       9.0     0.9992845351747923
epoch=8.0       nf1             0.9             0.0001469042749144      0.5276801554925248      0.7801295017685015      0.17313078701465529     555.9529906320274       9.0     0.9992757706146342
epoch=9.0       nf1             0.8             0.0001469042749144      0.532607098866577       0.7877798243928898      0.17166288183615921     528.977455843965        9.0     0.9993105869636878
```

```sh
{'cluster_loss': 0.0, 'centri_loss': 0.0, 'combined_loss': 0.3189, 'epoch': 20.0}
{'cluster_loss': 0.0, 'centri_loss': 0.0194, 'combined_loss': 0.3352, 'epoch': 20.0}
{'cluster_loss': 0.0, 'centri_loss': 0.0449, 'combined_loss': 0.3572, 'epoch': 20.0}
{'cluster_loss': 0.0, 'centri_loss': 0.0448, 'combined_loss': 0.3569, 'epoch': 20.0}
{'cluster_loss': 0.0, 'centri_loss': 0.0346, 'combined_loss': 0.3482, 'epoch': 20.0}
{'cluster_loss': 0.0, 'centri_loss': 0.0283, 'combined_loss': 0.3428, 'epoch': 20.0}
{'cluster_loss': 0.0, 'centri_loss': 0.0394, 'combined_loss': 0.3524, 'epoch': 20.0}
{'cluster_loss': 0.0, 'centri_loss': 0.057, 'combined_loss': 0.3681, 'epoch': 20.0}
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:14<00:00, 186.90it/s]
Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:14<00:00, 190.44it/s]
computing metrics.......
H1: 13, H10: 27268, H100: 59048
MRR: 0.10234491224308012, MR: 404.929632852316
Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:14<00:00, 189.09it/s]
computing metrics.......
H1: 13, H10: 29312, H100: 65302
MRR: 0.1095210187023194, MR: 378.42785305052377
Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.38it/s]
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:14<00:00, 194.74it/s]
computing metrics.......
H1: 13, H10: 32016, H100: 68854
MRR: 0.1180585318677859, MR: 367.5121874046535
Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:14<00:00, 188.56it/s]
computing metrics.......
H1: 13, H10: 35770, H100: 70514
MRR: 0.12845306203306153, MR: 367.1989422892206
Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:14<00:00, 184.83it/s]
computing metrics.......
H1: 13, H10: 40058, H100: 71157
MRR: 0.1399344270118707, MR: 375.05829839648334
Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:14<00:00, 189.95it/s]
computing metrics.......
H1: 13, H10: 44240, H100: 71305
MRR: 0.15188102587975863, MR: 389.92166612048413
Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:14<00:00, 188.38it/s]
computing metrics.......
H1: 13, H10: 46949, H100: 71142
MRR: 0.16282277180908203, MR: 411.44315369577254
Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:14<00:00, 186.26it/s]
computing metrics.......
H1: 13, H10: 48046, H100: 70759
MRR: 0.17166972210730008, MR: 439.6269761450058
Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:14<00:00, 188.61it/s]
computing metrics.......
H1: 13, H10: 48174, H100: 70150
MRR: 0.17707516417856864, MR: 474.85236120371104
Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:14<00:00, 191.68it/s]
computing metrics.......
H1: 13, H10: 47621, H100: 69396
MRR: 0.17860439042224602, MR: 517.7282722927238
Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:14<00:00, 191.40it/s]
computing metrics.......
H1: 13, H10: 46476, H100: 68391
MRR: 0.1757804676445304, MR: 569.0928322014171
Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:14<00:00, 187.55it/s]
computing metrics.......
H1: 13, H10: 44754, H100: 67195
MRR: 0.16985106306056105, MR: 629.8414789870385
Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:14<00:00, 188.83it/s]
computing metrics.......
H1: 13, H10: 42627, H100: 65865
MRR: 0.16161128402229366, MR: 701.2100731131276
Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:14<00:00, 187.51it/s]
computing metrics.......
H1: 13, H10: 40052, H100: 64214
MRR: 0.15154608164659747, MR: 784.5272055416813
Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:14<00:00, 188.88it/s]
computing metrics.......
H1: 18, H10: 37483, H100: 62489
MRR: 0.1417079827622413, MR: 881.2074627371657
Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:14<00:00, 192.09it/s]
computing metrics.......
H1: 254, H10: 34897, H100: 60436
MRR: 0.13326258605838115, MR: 992.8403489541546
Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:14<00:00, 187.88it/s]
computing metrics.......
H1: 1649, H10: 32516, H100: 58181
MRR: 0.1344812682335521, MR: 1121.0758252065134
Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:14<00:00, 188.47it/s]
computing metrics.......
H1: 3665, H10: 30353, H100: 55699
MRR: 0.1444493588186359, MR: 1267.9140270981886
Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [00:14<00:00, 191.05it/s]
computing metrics.......
H1: 4625, H10: 28534, H100: 53191
MRR: 0.15039850644644231, MR: 1435.2703716678154
Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2766/2766 [04:55<00:00,  9.37it/s]
INFO:hierarchy_transformers.evaluation.ont_eval:Eval results: {'axiom_kind': 'nf1', 'centri_weight': 0.9, 'H@1': np.float64(0.0001469042749144), 'H@10': np.float64(0.5381329596691263), 'H@100': np.float64(0.7841976201507463), 'MRR': np.float64(0.17860439042224602), 'MR': np.float64(517.7282722927238), 'median': np.float64(8.0), 'AUC': np.float64(0.999325681870819)}
computing metrics.......
H1: 4318, H10: 26943, H100: 50516
MRR: 0.14791232307688218, MR: 1625.2770501621596
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49720/49720 [69:14:26<00:00,  1.83s/it]INFO:sentence_transformers.trainer:Saving model checkpoint to experiments/OnTr-all-MiniLM-L12-v2-H200-OnT-FULL-64-LR-5e-6-cosine-annealing-20-epochs-grad-acc-8-downweighted-logical-loss-075-downweighted-centripetal-loss-085/checkpoint-49720
{'eval_axiom_kind': 'nf1', 'eval_centri_weight': 0.9, 'eval_H@1': np.float64(0.0001469042749144), 'eval_H@10': np.float64(0.5381329596691263), 'eval_H@100': np.float64(0.7841976201507463), 'eval_MRR': np.float64(0.17860439042224602), 'eval_MR': np.float64(517.7282722927238), 'eval_median': np.float64(8.0), 'eval_AUC': np.float64(0.999325681870819), 'eval_runtime': 6406.9, 'eval_samples_per_second': 0.0, 'eval_steps_per_second': 0.0, 'epoch': 20.0}
INFO:sentence_transformers.SentenceTransformer:Save model to experiments/OnTr-all-MiniLM-L12-v2-H200-OnT-FULL-64-LR-5e-6-cosine-annealing-20-epochs-grad-acc-8-downweighted-logical-loss-075-downweighted-centripetal-loss-085/checkpoint-49720
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49720/49720 [69:14:29<00:00,  5.01s/it]
{'train_runtime': 249270.2901, 'train_samples_per_second': 102.088, 'train_steps_per_second': 0.199, 'train_loss': 0.3647588308166326, 'epoch': 20.0}
0.9
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 23835/23835 [02:13<00:00, 178.11it/s]
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4039/4039 [00:22<00:00, 180.43it/s]
Evaluating nf1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4039/4039 [07:10<00:00,  9.37it/s]
computing metrics.......
H1: 16, H10: 54079, H100: 79937
MRR: 0.13861776705790535, MR: 4793.696158161489
INFO:hierarchy_transformers.evaluation.ont_eval:Eval results nf1: {'axiom_kind': 'nf1', 'centri_weight': 0.9, 'H@1': np.float64(0.00012380547065423452), 'H@10': np.float64(0.4184547529693968), 'H@100': np.float64(0.6185398692304717), 'MRR': np.float64(0.13861776705790535), 'MR': np.float64(4793.696158161489), 'median': np.float64(22.0), 'AUC': np.float64(0.9937179351195513)}
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1682/1682 [00:09<00:00, 172.49it/s]
Evaluating nf2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1682/1682 [02:59<00:00,  9.37it/s]
computing metrics.......
H1: 16772, H10: 31094, H100: 43871
MRR: 0.383828173300188, MR: 451.98961063098227
INFO:hierarchy_transformers.evaluation.ont_eval:Eval results nf2: {'axiom_kind': 'nf2', 'centri_weight': 0.9, 'H@1': np.float64(0.3117182417990893), 'H@10': np.float64(0.5779016819998142), 'H@100': np.float64(0.8153703187436112), 'MRR': np.float64(0.383828173300188), 'MR': np.float64(451.98961063098227), 'median': np.float64(7.0), 'AUC': np.float64(0.9994127146440184)}
Batches: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1849/1849 [00:10<00:00, 178.33it/s]
Evaluating nf3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1849/1849 [05:55<00:00,  5.20it/s]
computing metrics.......
H1: 15679, H10: 25072, H100: 41698
MRR: 0.3106133001097696, MR: 1844.0187648978074
INFO:hierarchy_transformers.evaluation.ont_eval:Eval results nf3: {'axiom_kind': 'nf3', 'centri_weight': 0.9, 'H@1': np.float64(0.26505840785758966), 'H@10': np.float64(0.4238500160600477), 'H@100': np.float64(0.704917755650601), 'MRR': np.float64(0.3106133001097696), 'MR': np.float64(1844.0187648978074), 'median': np.float64(18.0), 'AUC': np.float64(0.9975898283655649)}
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 551/551 [00:02<00:00, 184.48it/s]
Evaluating nf4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 551/551 [00:58<00:00,  9.37it/s]
computing metrics.......
H1: 15939, H10: 17122, H100: 17555
MRR: 0.927333665362395, MR: 4.015095624538902
INFO:hierarchy_transformers.evaluation.ont_eval:Eval results nf4: {'axiom_kind': 'nf4', 'centri_weight': 0.9, 'H@1': np.float64(0.9045457125021281), 'H@10': np.float64(0.9716815163725101), 'H@100': np.float64(0.9962544690993701), 'MRR': np.float64(0.927333665362395), 'MR': np.float64(4.015095624538902), 'median': np.float64(1.0), 'AUC': np.float64(0.9999962448575239)}
INFO:hierarchy_transformers.evaluation.ont_eval:Combined eval results: {'axiom_kind': 'combined', 'centri_weight': 0.9, 'H@1': 0.18631020653236546, 'H@10': 0.490223775470144, 'H@100': 0.7045848183700647, 'MRR': np.float64(0.2820494547980054), 'MR': np.float64(2898.1602838954022), 'median': np.float64(11.0), 'AUC': np.float64(0.9962029086590458)}
INFO:sentence_transformers.SentenceTransformer:Save model to experiments/OnTr-all-MiniLM-L12-v2-H200-OnT-FULL-64-LR-5e-6-cosine-annealing-20-epochs-grad-acc-8-downweighted-logical-loss-075-downweighted-centripetal-loss-085/final
```

